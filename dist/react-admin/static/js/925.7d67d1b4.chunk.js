(self.webpackChunkreact_admin=self.webpackChunkreact_admin||[]).push([[925],{8077:function(e,t,n){"use strict";n.d(t,{Rd:function(){return y},h8:function(){return C},B9:function(){return k},RT:function(){return T},UV:function(){return b},Q4:function(){return p},dA:function(){return N},JV:function(){return Z},Vd:function(){return h},bG:function(){return f},lE:function(){return w},p:function(){return m},gG:function(){return I},OC:function(){return v},$r:function(){return P},zb:function(){return S},x$:function(){return g},JR:function(){return j},ul:function(){return x},n$:function(){return l}});var r=n(1413),o=n(4569),i=n.n(o),a=n(2808),u=n.n(a),c=n(7607),s=n(3695),d=i().create({});d.interceptors.request.use((function(e){return e.url.includes("/v3/")||(e.url="/v1_0"+e.url),c.Z.getStorage("tokenName")&&c.Z.getStorage("tokenValue")&&(e.headers.Authorization=c.Z.getStorage("tokenName")+" "+"".concat(c.Z.getStorage("tokenValue"))),!e.data||"multiple/form-data"===e.headers["Content-Type"]||"application/json"===e.headers["Content-Type"]||"application/x-www-form-urlencoded"!==e.headers["Content-Type"]&&"post"!==e.method||(e.data=u().stringify(e.data,{allowDots:!0})),"get"===e.method&&(e.params=(0,r.Z)((0,r.Z)({},e.params),{},{time:(new Date).getTime()})),e})),d.interceptors.response.use((function(e){if(e.status>=200&&e.status<300)return 401===e.data.code?s.ZP.error(e.data.error):e.data.code>=-1&&e.data.code<=-1&&(window.location.href="/login"),e.data}),(function(e){throw s.ZP.error(e.message),new Error("\u7f51\u7edc\u9519\u8bef")}));var l=function(e){return d({url:"/login/doLogin",method:"POST",data:e})},f=function(){return d.get("/system/user/current/user")},m=function(e){return d.get("/v3/weather/weatherInfo?key=6d78e0a70cbe6fc669f1a0705a85a5b5&city="+e)},p=function(){return d.get("/v3/ip?key=6d78e0a70cbe6fc669f1a0705a85a5b5")},h=function(e){return d.get("/system/role/page",{params:e})},Z=function(e){return d.get("/system/role/list",{params:e})},g=function(e){return d.post("/system/role/save",e)},x=function(e){return d.post("/system/role/update",e)},y=function(e){return d.delete("/system/role/remove",{params:{ids:e}})},v=function(e){return d.post("/system/role/relation/api",e)},w=function(e){return d.get("/system/user/page",{params:e})},j=function(e){return d.post("/system/user/save",e)},S=function(e){return d.post("/system/user/reset/password",{id:e})},C=function(e){return d.delete("/system/user/remove",{params:{ids:e}})},k=function(e){return d.post("/system/user/disable",e)},b=function(e){return d.get("/system/api/page",{params:e})},T=function(e){return d.get("/system/api/list",{params:e})},I=function(){return d.get("/system/api/refresh")},P=function(e){return d.post("/system/user/relation/role",e)},N=function(e){return d.get("/system/logs/page",{params:e})}},7157:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return F}});var r=n(5861),o=n(3433),i=n(1413),a=n(9439),u=n(7757),c=n.n(u),s=n(2791),d=n(7031),l=n(3272),f=n(3099),m=n(7309),p=n(6038),h=n(3695),Z=n(8164),g=n(9004),x=n(8006),y=n(4997),v=n(2682),w=n(2426),j=n.n(w),S=n(8077),C={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"}}]},name:"edit",theme:"outlined"},k=n(4291),b=function(e,t){return s.createElement(k.Z,(0,i.Z)((0,i.Z)({},e),{},{ref:t,icon:C}))};b.displayName="EditOutlined";var T=s.forwardRef(b),I=n(161),P=n(2622),N=n(9286),z=n(184),R=d.Z.Search;function F(){var e=(0,s.useState)(!0),t=(0,a.Z)(e,2),n=t[0],u=t[1],w=(0,s.useState)(!1),C=(0,a.Z)(w,2),k=C[0],b=C[1],F=(0,s.useState)(!1),V=(0,a.Z)(F,2),O=V[0],Y=V[1],B=(0,s.useState)(!1),D=(0,a.Z)(B,2),L=D[0],M=D[1],E=(0,s.useState)({list:[],count:0}),H=(0,a.Z)(E,2),U=H[0],$=H[1],A=(0,s.useState)({current:1,roleName:"",size:10}),K=(0,a.Z)(A,2),_=K[0],q=K[1],G=(0,s.useState)([]),J=(0,a.Z)(G,2),Q=J[0],W=J[1],X=(0,s.useState)(),ee=(0,a.Z)(X,2),te=(ee[0],ee[1]),ne=(0,s.useState)({}),re=(0,a.Z)(ne,2),oe=re[0],ie=re[1],ae=(0,s.useState)([]),ue=(0,a.Z)(ae,2),ce=ue[0],se=ue[1],de=(0,s.useState)([]),le=(0,a.Z)(de,2),fe=le[0],me=le[1],pe=l.Z.useForm(),he=(0,a.Z)(pe,1)[0],Ze=[{title:"\u5e8f\u53f7",dataIndex:"index",width:80,fixed:"left",render:function(e,t,n){return"".concat((_.current-1)*_.size+n+1)}},{title:"\u89d2\u8272\u540d\u79f0",dataIndex:"roleName",width:200},{title:"\u89d2\u8272\u62fc\u97f3",dataIndex:"roleFlag",width:200},{title:"\u521b\u5efa\u65f6\u95f4",width:180,dataIndex:"createdTime",render:function(e){return j()(e).format("YYYY-MM-DD HH:mm:ss")}},{title:"\u66f4\u65b0\u65f6\u95f4",width:180,dataIndex:"updatedTime",render:function(e){return e?j()(e).format("YYYY-MM-DD HH:mm:ss"):""}},{title:"\u521b\u5efa\u4eba",width:180,dataIndex:"createdBy"},{title:"\u66f4\u65b0\u4eba",width:180,dataIndex:"updatedBy"},{title:"\u64cd\u4f5c",align:"center",fixed:"right",width:160,render:function(e){return(0,z.jsx)("div",{className:"control-group",children:(0,z.jsxs)(f.Z,{size:"middle",children:[(0,z.jsx)(m.Z,{type:"primary",shape:"circle",icon:(0,z.jsx)(T,{}),onClick:function(){ge(e)}}),(0,z.jsx)(m.Z,{type:"primary",shape:"circle",icon:(0,z.jsx)(I.Z,{}),onClick:function(){xe(e)}}),(0,z.jsx)(p.Z,{title:"\u786e\u8ba4\u5220\u9664\uff1f",placement:"left",onConfirm:function(){ye(e)},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",children:(0,z.jsx)(m.Z,{type:"primary",danger:!0,shape:"circle",icon:(0,z.jsx)(P.Z,{})})})]})})}}],ge=function(e){Y(!0),he.setFieldsValue((0,i.Z)({},e))},xe=function(e){ie(e),(0,S.RT)({roleId:e.id}).then((function(e){if(200==e.code){var t=e.data.map((function(e){return e.key=e.id,e})),n=e.data.filter((function(e){return e.disabled})).map((function(e){return e.key=e.id,e.disabled=!e.disabled,e.key}));W(t),se(n)}else h.ZP.error(e.error)})),M(!0)},ye=function(e){(0,S.Rd)(e.id).then((function(e){200==e.code?(h.ZP.success("\u5220\u9664\u6210\u529f"),q((0,i.Z)((0,i.Z)({},_),{},{current:1}))):h.ZP.error(e.error)}))},ve=function(){var e=(0,r.Z)(c().mark((function e(){var t,n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,S.Vd)((0,i.Z)((0,i.Z)({},_),{},{roleName:_.roleName||void 0}));case 2:200==(t=e.sent).code?(n=t.records,r=t.total,$({list:n,count:r})):h.ZP.error(t.error),u(!1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,s.useEffect)((function(){u(!0),ve()}),[_]),(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)(Z.Z,{children:[(0,z.jsx)(Z.Z.Item,{children:(0,z.jsx)("a",{href:"",children:"\u9996\u9875"})}),(0,z.jsx)(Z.Z.Item,{children:(0,z.jsx)("a",{href:"",children:"\u89d2\u8272\u7ba1\u7406"})})]}),(0,z.jsx)(g.Z,{style:{width:"100%",marginTop:20,overflow:"hidden"},children:(0,z.jsx)(R,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d\u79f0",loading:n,enterButton:!0,onSearch:function(e){q((0,i.Z)((0,i.Z)({},_),{},{roleName:e}))}})}),(0,z.jsxs)(g.Z,{style:{width:"100%",marginTop:20,overflow:"hidden"},loading:n,children:[(0,z.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:25},children:[(0,z.jsxs)("p",{style:{marginBottom:0},children:["\u6839\u636e\u7b5b\u9009\u6761\u4ef6\u5171\u67e5\u8be2\u5230",U.count,"\u6761\u7ed3\u679c"]}),(0,z.jsx)(m.Z,{type:"primary",icon:(0,z.jsx)(N.Z,{}),onClick:function(){Y(!0)},children:"\u65b0\u589e"})]}),(0,z.jsx)(x.Z,{className:"menuMainTainTable",columns:Ze,dataSource:U.list||[],scroll:{x:1300},pagination:{pageSize:_.size,current:_.current,onChange:function(e){q((0,i.Z)((0,i.Z)({},_),{},{current:e}))},total:U.count,showSizeChanger:!1},rowKey:function(e){return e.id}})]}),(0,z.jsx)(y.Z,{title:he.getFieldValue("id")?"\u7f16\u8f91":"\u65b0\u589e",visible:O,onOk:function(){return he.submit()},onCancel:function(){return Y(!1)},afterClose:function(){return he.resetFields()},confirmLoading:k,forceRender:!0,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",children:(0,z.jsx)(l.Z,(0,i.Z)((0,i.Z)({},{labelCol:{span:6},wrapperCol:{span:15}}),{},{form:he,onFinish:function(e){b(!0);var t=he.getFieldValue("id");t?(0,S.ul)((0,i.Z)((0,i.Z)({},e),{},{id:t})).then((function(e){200==e.code?(Y(!1),q((0,i.Z)((0,i.Z)({},_),{},{current:1})),h.ZP.success("\u4fdd\u5b58\u6210\u529f")):h.ZP.error(e.error)})).finally((function(){b(!1)})):(0,S.x$)(e).then((function(e){200==e.code?(Y(!1),q((0,i.Z)((0,i.Z)({},_),{},{current:1})),h.ZP.success("\u4fdd\u5b58\u6210\u529f")):h.ZP.error(e.error)})).finally((function(){b(!1)}))},children:(0,z.jsx)(l.Z.Item,{name:"roleName",label:"\u89d2\u8272\u540d\u79f0",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d\u79f0"}],children:(0,z.jsx)(d.Z,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d\u79f0"})})}))}),(0,z.jsx)(y.Z,{title:"\u7ed1\u5b9aApi",visible:L,onOk:function(){(0,S.OC)({roleId:oe.id,apiIds:null===ce||void 0===ce?void 0:ce.join(",")}).then((function(e){200==e.code?(h.ZP.success("\u7ed1\u5b9a\u6210\u529f"),M(!1),q((0,i.Z)((0,i.Z)({},_),{},{current:1}))):h.ZP.error(e.error)}))},bodyStyle:{display:"flex",justifyContent:"center"},onCancel:function(){he.resetFields(),M(!1)},width:"750px",confirmLoading:k,forceRender:!0,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",children:(0,z.jsx)(v.Z,{dataSource:Q,targetKeys:ce,onChange:function(e,t,n){se(e)},showSearch:!0,onSearch:function(e){te(e)},selectedKeys:fe,onSelectChange:function(e,t){me([].concat((0,o.Z)(e),(0,o.Z)(t)))},render:function(e){return e.apiName},pagination:!0})})]})}},7607:function(e,t){"use strict";var n={getCookie:function(e){var t=document.cookie,n=t.indexOf(e+"=");if(n>-1){n=n+e.length+1;var r=t.indexOf(";",n);return r=r<0?t.length:r,decodeURIComponent(t.substring(n,r))}return""},setCookie:function(e,t,n){var r=n,o=new Date;o.setTime(o.getTime()+24*r*3600*1e3),document.cookie=e+"="+encodeURIComponent(t)+";expires="+(void 0===r?"":o.toUTCString())},delCookie:function(e){var t=this.getCookie(e);!1!==t&&this.setCookie(e,t,-1)},getStorage:function(e){return localStorage.getItem(e)},setStorage:function(e,t){return localStorage.setItem(e,t)},delStorage:function(e){localStorage.removeItem(e)}};t.Z=n},4654:function(){}}]);
//# sourceMappingURL=925.7d67d1b4.chunk.js.map